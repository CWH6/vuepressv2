import{_ as n,o as a,c as s,e as p}from"./app-A-PqZFtg.js";const t={},e=p(`<h3 id="ğŸª¸gateway-æœåŠ¡ç½‘å…³" tabindex="-1"><a class="header-anchor" href="#ğŸª¸gateway-æœåŠ¡ç½‘å…³" aria-hidden="true">#</a> ğŸª¸Gateway æœåŠ¡ç½‘å…³</h3><p><strong>Spring Cloud Gateway</strong> æ˜¯ Spring Cloud æä¾›çš„å…¨æ–°çš„æœåŠ¡ç½‘å…³ï¼Œå®ƒåŸºäº Spring 5ã€Project Reactor å’Œ Spring Boot 2 æŠ€æœ¯æ ˆå¼€å‘ï¼Œç”¨äºå¤„ç†æ‰€æœ‰è¿›å…¥åº”ç”¨ç¨‹åºçš„è¯·æ±‚æµé‡ã€‚å®ƒæä¾›äº†ä¸€ç§éå¸¸çµæ´»ã€å¼ºå¤§ä¸”å…·æœ‰å“åº”å¼ç¼–ç¨‹ç‰¹æ€§çš„æ–¹å¼æ¥è·¯ç”±è¯·æ±‚ã€è¿‡æ»¤è¯·æ±‚ä»¥åŠå¤„ç†è¯·æ±‚ã€‚</p><h3 id="ğŸ§Šspring-cloud-gateway-çš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬" tabindex="-1"><a class="header-anchor" href="#ğŸ§Šspring-cloud-gateway-çš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬" aria-hidden="true">#</a> ğŸ§ŠSpring Cloud Gateway çš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š</h3><p><strong>åŸºäº WebFlux</strong>ï¼š</p><p>Spring Cloud Gateway æ˜¯åŸºäº Spring WebFlux æ¡†æ¶æ„å»ºçš„ï¼Œä½¿ç”¨äº† Reactor è¿™ä¸ªå“åº”å¼ç¼–ç¨‹çš„åº“ï¼Œå› æ­¤å¯ä»¥å¤„ç†é«˜å¹¶å‘çš„è¯·æ±‚ã€‚</p><p><strong>åŠ¨æ€è·¯ç”±</strong>ï¼š</p><p>å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶ã€ä»£ç æˆ–è€…æœåŠ¡æ³¨å†Œä¸­å¿ƒç­‰æ–¹å¼å®šä¹‰è·¯ç”±è§„åˆ™ï¼Œå®ç°åŠ¨æ€çš„è¯·æ±‚è·¯ç”±ï¼Œä»è€Œæ ¹æ®è¯·æ±‚çš„æ¡ä»¶å°†è¯·æ±‚è½¬å‘åˆ°ä¸åŒçš„æœåŠ¡æˆ–è€…è·¯å¾„ã€‚</p><p><strong>è¿‡æ»¤å™¨</strong></p><p>æ”¯æŒå¤šç§å†…ç½®çš„è¿‡æ»¤å™¨ï¼Œæ¯”å¦‚æ·»åŠ è¯·æ±‚å¤´ã€æ·»åŠ å“åº”å¤´ã€è¯·æ±‚è½¬å‘ã€é‡å®šå‘ã€é™æµã€æƒé™æ§åˆ¶ç­‰ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒè‡ªå®šä¹‰è¿‡æ»¤å™¨æ¥æ»¡è¶³ç‰¹å®šçš„ä¸šåŠ¡éœ€æ±‚ã€‚</p><p><strong>è´Ÿè½½å‡è¡¡</strong>ï¼š</p><p>é›†æˆäº† Spring Cloud Ribbon å’Œ Spring Cloud LoadBalancerï¼Œå¯ä»¥å®ç°å¯¹è¯·æ±‚çš„è´Ÿè½½å‡è¡¡ï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªå®ä¾‹ä¸Š</p><p><strong>æ–­è·¯å™¨</strong>ï¼š</p><p>å¯ä»¥é›†æˆæ–­è·¯å™¨æ¥å®ç°å¯¹æœåŠ¡çš„ç†”æ–­å’Œé™çº§å¤„ç†ï¼Œæé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</p><p><strong>æœåŠ¡å‘ç°</strong>ï¼š</p><p>æ”¯æŒé›†æˆæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ˆå¦‚ Eurekaã€Consul ç­‰ï¼‰ï¼Œå¯ä»¥åŠ¨æ€åœ°ä»æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡åˆ—è¡¨ï¼Œå¹¶å®ç°æœåŠ¡çš„åŠ¨æ€è·¯ç”±ã€‚</p><p><strong>é›†æˆæ€§</strong>ï¼š</p><p>å¯ä»¥ä¸ Spring Cloud å¾®æœåŠ¡æ¡†æ¶æ— ç¼é›†æˆï¼Œä¸ Spring Boot åº”ç”¨ç¨‹åºç´§å¯†ç»“åˆï¼Œç®€åŒ–äº†å¾®æœåŠ¡æ¶æ„ä¸­çš„ç½‘å…³å±‚çš„å¼€å‘å’Œéƒ¨ç½²ã€‚</p><h3 id="ğŸ“¦ä½¿ç”¨-spring-cloud-gateway-çš„åŸºæœ¬æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#ğŸ“¦ä½¿ç”¨-spring-cloud-gateway-çš„åŸºæœ¬æ­¥éª¤" aria-hidden="true">#</a> ğŸ“¦ä½¿ç”¨ Spring Cloud Gateway çš„åŸºæœ¬æ­¥éª¤ï¼š</h3><p><strong>å¼•å…¥ Spring Cloud Gateway ä¾èµ–</strong>ï¼š</p><p>åœ¨ä½ çš„é¡¹ç›®ä¸­å¼•å…¥ Spring Cloud Gateway çš„ä¾èµ–ï¼Œæ¯”å¦‚ä½¿ç”¨ Mavenï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-gateway<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç¼–å†™è·¯ç”±é…ç½®</strong>ï¼š</p><p>åœ¨é…ç½®æ–‡ä»¶ä¸­ç¼–å†™ Spring Cloud Gateway çš„è·¯ç”±é…ç½®ï¼Œå¯ä»¥ä½¿ç”¨ YAML æˆ–è€… Properties æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ YAML é…ç½®ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> my_route
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//example.com
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/myPath/<span class="token important">**</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªé…ç½®å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>my_route</code> çš„è·¯ç”±è§„åˆ™ï¼Œå°† <code>/myPath/**</code> çš„è¯·æ±‚è½¬å‘åˆ° <code>http://example.com</code>ã€‚</p><p><strong>è‡ªå®šä¹‰è¿‡æ»¤å™¨</strong>ï¼š</p><p>å¦‚æœéœ€è¦ï¼Œå¯ä»¥ç¼–å†™è‡ªå®šä¹‰çš„è¿‡æ»¤å™¨æ¥å¤„ç†è¯·æ±‚ã€‚ä¾‹å¦‚ï¼Œåˆ›å»ºä¸€ä¸ªå®ç° <code>GlobalFilter</code> æ¥å£çš„è¿‡æ»¤å™¨ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>gateway<span class="token punctuation">.</span>filter<span class="token punctuation">.</span></span><span class="token class-name">GlobalFilter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">Ordered</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>server<span class="token punctuation">.</span></span><span class="token class-name">ServerWebExchange</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">reactor<span class="token punctuation">.</span>core<span class="token punctuation">.</span>publisher<span class="token punctuation">.</span></span><span class="token class-name">Mono</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCustomFilter</span> <span class="token keyword">implements</span> <span class="token class-name">GlobalFilter</span><span class="token punctuation">,</span> <span class="token class-name">Ordered</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">ServerWebExchange</span> exchange<span class="token punctuation">,</span> <span class="token class-name">GatewayFilterChain</span> chain<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è‡ªå®šä¹‰è¿‡æ»¤å™¨é€»è¾‘</span>
        <span class="token keyword">return</span> chain<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å¯åŠ¨åº”ç”¨ç¨‹åº</strong></p><p>ç°åœ¨å¯ä»¥å¯åŠ¨ Spring Boot åº”ç”¨ç¨‹åºï¼ŒSpring Cloud Gateway å°†ä¼šåŠ è½½é…ç½®å¹¶å¼€å§‹ç›‘å¬æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</p><p><strong>è®¿é—®ç½‘å…³</strong>ï¼š</p><p>å¯ä»¥é€šè¿‡é…ç½®çš„è·¯ç”±è§„åˆ™è®¿é—® Spring Cloud Gatewayï¼Œè¯·æ±‚ä¼šè¢«è·¯ç”±åˆ°ç›¸åº”çš„ç›®æ ‡æœåŠ¡ä¸Šã€‚ä¾‹å¦‚ï¼Œå¦‚æœé…ç½®äº†è·¯ç”±è§„åˆ™å°† <code>/myPath/**</code> è½¬å‘åˆ° <code>http://example.com</code>ï¼Œé‚£ä¹ˆè®¿é—® <code>http://localhost:8080/myPath/</code> å°†ä¼šè¢«è½¬å‘åˆ° <code>http://example.com/myPath/</code>ã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒSpring Cloud Gateway æ˜¯ä¸€ä¸ªå¼ºå¤§ã€çµæ´»ä¸”å…·æœ‰å“åº”å¼ç¼–ç¨‹ç‰¹æ€§çš„æœåŠ¡ç½‘å…³ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…å®ç°è·¯ç”±ã€è¿‡æ»¤ã€è´Ÿè½½å‡è¡¡ã€æ–­è·¯å™¨ç­‰åŠŸèƒ½ï¼Œå®ç°å¾®æœåŠ¡æ¶æ„ä¸­çš„è¯·æ±‚å¤„ç†å’Œè·¯ç”±æ§åˆ¶ã€‚å®ƒçš„é…ç½®ç®€å•ç›´è§‚ï¼Œé›†æˆäº† Spring Cloud çš„ä¼˜ç§€ç‰¹æ€§ï¼Œæ˜¯æ„å»ºç°ä»£åŒ–ã€é«˜æ•ˆçš„å¾®æœåŠ¡ç³»ç»Ÿçš„é‡è¦</p>`,33),o=[e];function c(l,i){return a(),s("div",null,o)}const r=n(t,[["render",c],["__file","Gateway.html.vue"]]);export{r as default};
